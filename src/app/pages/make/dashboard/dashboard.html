<div class="wrap">
  <header class="top">
    <div class="greet">
      <h1>Welcome back<span *ngIf="userEmail()">, {{ userEmail() }}</span></h1>
      <p class="muted">Make • organize • send — faster than email threads.</p>
    </div>

    <div class="actions">
      <a class="btn primary" routerLink="/pack/new">+ New Pack</a>
      <button class="btn" routerLink="/upload">Upload</button>
      <button class="btn ghost" (click)="share()">Create Share</button>
    </div>
  </header>

  <section class="toolbar">
    <div class="search">
      <input [(ngModel)]="q" (input)="onSearch()" placeholder="Search title, tag, key, BPM…" />
    </div>
    <div class="filters">
      <button class="chip" [class.on]="filter==='all'" (click)="setFilter('all')">All</button>
      <button class="chip" [class.on]="filter==='private'" (click)="setFilter('private')">Private</button>
      <button class="chip" [class.on]="filter==='public'" (click)="setFilter('public')">Public</button>
    </div>
  </section>

  <h3 class="section">In Progress</h3>

  <!-- Skeletons -->
  <div class="grid" *ngIf="loading(); else content">
    <div class="card skeleton" *ngFor="let i of [0,1,2,3,4,5]">
      <div class="cover"></div>
      <div class="meta">
        <div class="line"></div>
        <div class="line sm"></div>
      </div>
    </div>
  </div>

  <ng-template #content>
    <div *ngIf="packs().length; else empty" class="grid">
      <a class="card" *ngFor="let p of packs()" [routerLink]="['/pack', p.id]">
        <div class="cover" [style.background]="coverFor(p.title)"></div>
        <div class="meta">
          <div class="title">{{ p.title }}</div>
          <div class="sub">
            {{ p.bpmMin || '—' }}–{{ p.bpmMax || '—' }} BPM
            · {{ (p.keys?.[0] || '—') }}
          </div>
        </div>
        <div class="badges">
          <span class="badge" [class.pub]="p.isPublic"> {{ p.isPublic ? 'Public' : 'Private' }} </span>
          <span class="ago">{{ p.updatedAt | date:'MMM d' }}</span>
        </div>
      </a>
    </div>

    <ng-template #empty>
      <div class="empty">
        <div class="art"></div>
        <h4>No packs yet</h4>
        <p class="muted">Start by creating a pack or uploading some loops.</p>
        <div class="row">
          <a class="btn primary" routerLink="/pack/new">Create your first pack</a>
          <button class="btn" (click)="upload()">Upload files</button>
        </div>
      </div>
    </ng-template>
  </ng-template>
</div>
